function getType(e){return Object.prototype.toString.call(e)}function isArray(e){return getType(e)===TYPE_ARRAY}function isFunction(e){return getType(e)===TYPE_FUNCTION}function getValue(e){return typeof e.value!==TYPE_UNDEFINED?e.value||"":typeof e.getAttribute!==TYPE_UNDEFINED?e.getAttribute("data-value")||"":e||""}function getLengthParams(e){var r="The parameters for length is illegal.";e=e[0];var a=/\s*([\(\[])\s*(\d+)?\s*,\s*(\d+)?\s*([\)\]])\s*/,t=e.match(a);if(null===t)throw new TypeError(r);var n=t[2],s=t[3];if(typeof n===TYPE_UNDEFINED)n=0;else if("("===t[1])n=+n+1;else{if("["!==t[1])throw new TypeError(r);n=+n}if(typeof s===TYPE_UNDEFINED)s=1/0;else if(")"===t[4])s=+s-1;else{if("]"!==t[4])throw new TypeError(r);s=+s}if(n!==n||s!==s)throw new TypeError(r);return[n,s]}function getRangeParams(e){var r="The parameters for range is illegal.";e=e[0];var a=/\s*([\(\[])\s*((0|([\+\-]?[1-9]\d*))(\.[0-9]+)?)?\s*,\s*((0|([\+\-]?[1-9]\d*))(\.[0-9]+)?)?\s*([\)\]])\s*/,t=e.match(a);if(null===t)throw new TypeError(r);var n,s,u=t[2],i=t[6];return u=typeof u===TYPE_UNDEFINED?-(1/0):+u,n="["===t[1],i=typeof i===TYPE_UNDEFINED?1/0:+i,s="]"===t[10],[n,u,i,s]}function priority(e,r){return priorityTable[e]>priorityTable[r]||priorityTable[e]===priorityTable[r]&&!/^(\*|\?|!)$/g.test(e)&&!/^(\*|\?|!)$/g.test(r)}function parseConditionExpression(e){for(var r,a=[],t=[],n=[],s=0,u="",i="",l=e.length;l>s;)switch(r=e[s++]){case"{":case"}":case"!":case"*":case"?":u.length>0&&a.push(u),a.push(r),u="";break;case"&":case"|":r===i?(u.length>0&&a.push(u),a.push(i+i),u="",i=""):i+=r;break;default:u+=r}u.length>0&&a.push(u),s=0,l=a.length;for(var o,f;l>s;)switch(r=a[s++]){case"{":n.push(r);break;case"||":case"&&":case"!":case"*":case"?":for(o=n.length-1;o>=0&&/^(\*|\?|\|\||&&|!)$/g.test(n[o])&&priority(n[o],r);)t.push(n.pop()),o--;n.push(r);break;case"}":for(o=n.length-1;o>=0&&(f=n.pop(),"{"!==f);)t.push(f),o--;break;default:t.push(r)}if(n.length>0)for(o=n.length-1;o>=0&&(f=n.pop(),"{"!==f);)t.push(f),o--;return t}function executeChecker(e,r,a){var t=e.split(":");e=t[0].replace(/length/i,"long");var n,s=a?apiCheckers[e]||defaultCheckers[e]:this.cs[e]||apiCheckers[e]||defaultCheckers[e];switch(getType(s)){case TYPE_ARRAY:n=calculateConditionExpression.call(this,s,r,a);break;case TYPE_FUNCTION:var u,i=t.slice(1);switch(e){case"long":u=getLengthParams(i);break;case"range":u=getRangeParams(i);break;default:u=i}if(a)u.unshift(r);else{var l=[];if(null!==r)for(var o=0;o<r.length;++o)l.push(getValue(r[o]));u.unshift(l)}n=s.apply(null,u);break;case TYPE_BOOLEAN:n=s;break;default:throw new TypeError("Checker for rule "+t[0]+" must be a Function.")}return n}function calculateConditionExpression(e,r,a){for(var t=[],n=0;n<e.length;++n){var s=e[n];switch(s){case"&&":var u=t.pop(),i=t.pop(),l=getType(i)===TYPE_STRING?executeChecker.call(this,i,r,a):i,o=getType(u)===TYPE_STRING?executeChecker.call(this,u,r,a):u,f=matrix.and(l,o);t.push(f);break;case"||":var u=t.pop(),i=t.pop(),l=getType(i)===TYPE_STRING?executeChecker.call(this,i,r,a):i,o=getType(u)===TYPE_STRING?executeChecker.call(this,u,r,a):u,f=matrix.or(l,o);t.push(f);break;case"!":var i=t.pop(),f=matrix.not(getType(i)===TYPE_STRING?executeChecker.call(this,i,r,a):i);t.push(f);break;case"*":var i=t.pop(),f=matrix.all(getType(i)===TYPE_STRING?executeChecker.call(this,i,r,a):i);t.push(f);break;case"?":var i=t.pop(),f=matrix.any(getType(i)===TYPE_STRING?executeChecker.call(this,i,r,a):i);t.push(f);break;default:t.push(s)}}var c=t.pop();return getType(c)===TYPE_STRING?executeChecker.call(this,c,r,a):c}function Validator(e){e=e||[],this.cs={},this.vs=parseValidations(e)}function parseValidations(e,r){e=getType(e)===TYPE_ARRAY?e:[e];for(var a=[],t=0;t<e.length;++t){var n=e[t],s={},u=r?r(n.field):n.field;s.fs=u?isArray(u)?u:[u]:null,s.rs=[];for(var i=isArray(n.rules)?n.rules:[n.rules],l=0;l<i.length;++l){var o=i[l],f={};f["if"]=parseConditionExpression(o["if"]),f.no=o.fail?o.fail:!1,f.yes=o.success?parseValidations(o.success):!1,s.rs.push(f)}a.push(s)}return a}function setRule(e,r){var a,t=r;switch(getType(t)){case TYPE_BOOLEAN:case TYPE_FUNCTION:a=t;break;case TYPE_STRING:try{a=parseConditionExpression(t)}catch(n){throw new Error("Cannot parse condition expression.")}break;case TYPE_REGEXP:a=function(e){var a=!0;if(isArray(e)){for(var n=0,s=e.length;s>n;++n)if(!t.test(e[n])){a=!1;break}}else r.rule.test(e)||(a=!1);return a};break;default:throw new TypeError("Rule type not support.")}this.cs[e]=a}function removeRule(e){typeof this.cs[e]!==TYPE_UNDEFINED&&delete this.cs[e]}function deepCheck(e){for(var r=!0,a=0;a<e.length;++a){for(var t=e[a],n=t.fs,s=t.rs,u=0;u<s.length;++u){var i=s[u],l=calculateConditionExpression.call(this,i["if"],n,!1);if(l=matrix.all(l),!l){var o=n.length<2?n[0]:n;i.no&&(r=!1,i.no.call(o));break}i.yes&&(r=deepCheck.call(this,i.yes))}if(!r)break}return r}function isEmpty(e){return null===e||typeof e===TYPE_UNDEFINED||""===e}function equal(e){if(!isArray(e))return!1;for(var r=!0,a=0;a<e.length-1;++a)if(e[a]!==e[a+1]){r=!1;break}return r}function empty(e){var r;if(isArray(e)){r=[];for(var a=0;a<e.length;++a)r.push(isEmpty(e[a]))}else r=isEmpty(e);return r}function long(e,r,a){var t,n;if(r=r||-(1/0),a=a||1/0,isArray(e)){t=[];for(var s=0;s<e.length;++s)n=e[s].length,t.push(n>=r&&a>=n)}else n=e.length,t=n>=r&&a>=n;return t}function range(e,r,a,t,n){var s;if(isArray(e)){s=[];for(var u=0;u<e.length;++u){var i=Number(e[u]);s.push((r&&i>=a||!r&&i>a)&&(n&&t>=i||!n&&t>i))}}else e=Number(e),s=(r&&e>=a||!r&&e>a)&&(n&&t>=e||!n&&t>e);return s}function registDefaultCheckers(e,r){var a;switch(getType(r)){case TYPE_REGEXP:a=function(e){var a;if(isArray(e)){a=[];for(var t=0;t<e.length;++t)a.push(r.test(e[t]))}else a=r.test(e);return a};break;case TYPE_FUNCTION:a=r;break;default:throw new TypeError("Default Matcher Type Error.")}defaultCheckers[e]=a,is[e]=a,not[e]=function(){return matrix.not(a.apply(null,arguments))},all[e]=function(){return matrix.all(a.apply(null,arguments))},any[e]=function(){return matrix.any(a.apply(null,arguments))}}function registApiChecker(e,r){var a;switch(getType(r)){case TYPE_STRING:var t;try{t=parseConditionExpression(r)}catch(n){throw console.error("无法解析的条件表达式"),new Error(n)}a=t;break;case TYPE_REGEXP:a=function(e){var a;if(isArray(e)){a=[];for(var t=0;t<e.length;++t)a.push(r.test(e[t]))}else a=r.test(e);return a};break;case TYPE_FUNCTION:a=r;break;default:throw new TypeError("API Checker Type Error.")}apiCheckers[e]=a}var matrix=function(){var e={};return e.or=function(e,r){var a=[],t=isArray(e),n=isArray(r);if(t&&n)for(var s=0;s<e.length;++s)a[s]=e[s]||r[s];else if(t)for(var s=0;s<e.length;++s)a[s]=e[s]||r;else if(n)for(var s=0;s<r.length;++s)a[s]=r[s]||e;else a=e||r;return a},e.and=function(e,r){var a=[],t=isArray(e),n=isArray(r);if(t&&n)for(var s=0;s<e.length;++s)a[s]=e[s]&&r[s];else if(t)for(var s=0;s<e.length;++s)a[s]=e[s]&&r;else if(n)for(var s=0;s<r.length;++s)a[s]=r[s]&&e;else a=e&&r;return a},e.not=function(e){var r=[];if(isArray(e))for(var a=0;a<e.length;++a)r[a]=!e[a];else r=!e;return r},e.all=function(e){var r=!0;if(isArray(e))for(var a=0;a<e.length;++a)r=r&&e[a];else r=r&&e;return r},e.any=function(e){var r=!1;if(isArray(e))for(var a=0;a<e.length;++a)r=r||e[a];else r=r||e;return r},e}(),hasOwn=function(e){return this.hasOwnProperty(e)},TYPE_STRING="[object String]",TYPE_ARRAY="[object Array]",TYPE_FUNCTION="[object Function]",TYPE_REGEXP="[object RegExp]",TYPE_BOOLEAN="[object Boolean]",TYPE_UNDEFINED="undefined",priorityTable={"||":0,"&&":1,"!":2,"*":2,"?":2},vprtt=Validator.prototype;vprtt.add=function(e){for(var r in e)hasOwn.call(e,r)&&setRule.call(this,r,e[r]);return this},vprtt.remove=function(e){if(isArray(e))for(var r=0;r<e.length;++r)removeRule.call(this,e[r]);else removeRule.call(this,e);return this},vprtt.check=function(){return deepCheck.call(this,this.vs)};var defaultCheckers={},defaultMatchers={url:/^(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?$/,email:/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i,number:/^(0|([\+\-]?[1-9]\d*))(\.[0-9]+)?$/,"int":/^(0|([\+\-]?[1-9]\d*))$/,positive:/^\+?[1-9]\d*$/,negative:/^\-[1-9]\d*$/,varName:/^[a-zA-Z_][a-zA-Z0-9_]*$/,nickName:/^[\u4E00-\u9FA5\uF900-\uFA2Da-zA-Z_][\u4E00-\u9FA5\uF900-\uFA2Da-zA-Z0-9_]*$/,QQ:/^[1-9][0-9]{4,}$/,ip:/^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$|^(([a-zA-Z]|[a-zA-Z][a-zA-Z0-9\-]*[a-zA-Z0-9])\.)*([A-Za-z]|[A-Za-z][A-Za-z0-9\-]*[A-Za-z0-9])$|^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,ipv4:/^(?:(?:\d|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])\.){3}(?:\d|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])$/,ipv6:/^(([a-zA-Z]|[a-zA-Z][a-zA-Z0-9\-]*[a-zA-Z0-9])\.)*([A-Za-z]|[A-Za-z][A-Za-z0-9\-]*[A-Za-z0-9])$|^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,upperCase:/^[A-Z]+$/,lowerCase:/^[a-z]+$/,empty:empty,equal:equal,"long":long,range:range,is:function(e,r){var a;if(isArray(e)){a=[];for(var t=0;t<e.length;++t)a.push(e[t]===r)}else a=e===r;return a},not:function(e,r){var a;if(isArray(e)){a=[];for(var t=0;t<e.length;++t)a.push(e[t]!==r)}else a=e!==r;return a}},apiCheckers={},is=Validator.is=function(e,r){return executeChecker.call(null,e,r,!0)},not=Validator.not=function(e,r){return matrix.not(is(e,r))},any=Validator.any=function(e,r){return matrix.any(is(e,r))},all=Validator.all=function(e,r){return matrix.all(is(e,r))};for(var m in defaultMatchers)hasOwn.call(defaultMatchers,m)&&registDefaultCheckers(m,defaultMatchers[m]);Validator.api=function(e){for(var r in e)hasOwn.call(e,r)&&registApiChecker.call(this,r,e[r]);return this},Validator.api.list=function(){console.log(apiCheckers)};var FormValidator=function(e,r){r=r||[],this.$form=getType(e)===TYPE_STRING?document.querySelectorAll(e)[0]:e,this.cs={};var a=this;this.vs=parseValidations(r,function(e){if(!e)return e;var r=[];if(isArray(e))for(var t=0;t<e.length;++t){var n=a.$form.querySelectorAll("[name="+e[t]+"]")[0]||a.$form.querySelectorAll("[data-name="+e[t]+"]")[0];r.push(n)}else{var n=a.$form.querySelectorAll("[name="+e+"]")[0]||a.$form.querySelectorAll("[data-name="+e+"]")[0];r.push(n)}return r})};FormValidator.prototype=new Validator,FormValidator.prototype.constructor=FormValidator,FormValidator.prototype.check=function(){return Validator.prototype.check.call(this,this.$form)},exports.Validator=Validator,exports.FormValidator=FormValidator;
//# sourceMappingURL=validator.min.js.map
