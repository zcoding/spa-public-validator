!function(e){"function"==typeof define&&define.cmd?define(function(r,t,n){e(t)}):e(window)}(function(e){function r(e){return null===e||"undefined"==typeof e||""===e}function t(e,r){"undefined"!=typeof f[e]&&console.warn('Warning: current api "'+e+'" will be overridden.'),f[e]=r,h[e]=function(r){return!f[e](r)}}var n=Object.prototype.toString,i={};i.isArray=function(e){return i.type(e)===i.TYPE_ARRAY},i.isFunction=function(e){return i.type(e)===i.TYPE_FUNCTION},i.getValue=function(e){return"undefined"==typeof e.value?e.getAttribute("data-value")||"":e.value},i.getLengthParams=function(e){e=e[0];var r=/\s*([\(\[])\s*(\d+)?\s*,\s*(\d+)?\s*([\)\]])\s*/,t=e.match(r);if(null===t)throw new TypeError("The parameters for length is illegal.");var n=t[2],i=t[3];if("undefined"==typeof n)n=0;else if("("===t[1])n=+n+1;else{if("["!==t[1])throw new TypeError("The parameters for length is illegal.");n=+n}if("undefined"==typeof i)i=Infinite;else if(")"===t[4])i=+i-1;else{if("]"!==t[4])throw new TypeError("The parameters for length is illegal.");i=+i}if(n!==n||i!==i)throw new TypeError("The parameters for length is illegal.");return[n,i]},i.type=function(e){return n.call(e)},i.TYPE_STRING="[object String]",i.TYPE_ARRAY="[object Array]",i.TYPE_FUNCTION="[object Function]",i.TYPE_REGEXP="[object RegExp]";var o=function(e){this.checkers={},this.validations=[]},a=o.prototype;a.add=function(e){function r(e){switch(i.type(e.rule)){case i.TYPE_FUNCTION:this.checkers[e.name]=e.rule;break;case i.TYPE_STRING:this.checkers[e.name]=function(){};break;case i.TYPE_REGEXP:this.checkers[e.name]=function(r){var t=!0;if(i.isArray(r)){for(var n=0,o=r.length;o>n;++n)if(!e.rule.test(r[n])){t=!1;break}}else e.rule.test(r)||(t=!1);return t};break;default:throw new TypeError("Rule type not support.")}}if(i.isArray(e))for(var t=0,n=e.length;n>t;++t)r.call(this,e[t]);else r.call(this,e);return this},a.check=function(){},a.remove=function(e){function r(e){"undefined"!=typeof this.checkers[e]&&delete this.checkers[e]}if(i.isArray(e))for(var t=0,n=e.length;n>t;++t)r(e[t]);else r(e);return this};var s=function(e,r){this.$form="string"==typeof e?document.querySelectorAll(e)[0]:e,this.validations=[],i.isArray(r)||(r=[r]);for(var t=0,n=r.length;n>t;++t){var o=r[t].field;i.isArray(o)||(o=[o]);for(var a=[],s=0;s<o.length;++s)a.push(this.$form.querySelectorAll("[name="+o[s]+"]")[0]);var l=r[t].rules;l=i.isArray(l)?l:[l],this.validations.push({$field:a,rules:l})}};s.prototype=new o,s.prototype.constructor=s,getChecker=function(e){var r=e.split(":");e=r[0].replace(/length/i,"long");var t=l.checkers[e]||this.checkers[e];if(!i.isFunction(t))throw new TypeError("Checker for rule "+r[0]+" must be a Function.");var n,o=r.slice(1);switch(e){case"long":n=i.getLengthParams(o);break;default:n=o}return[t,n]},s.prototype.check=function(){for(var e=this.$form,r=this.validations,t=!0,n=0,o=r.length;o>n;++n){for(var a=r[n].$field,s=r[n].rules,l=0;l<s.length;++l){for(var u=s[l],c=getChecker.call(this,u.type),f=[],h=0;h<a.length;++h)f.push(i.getValue(a[h]));if(c[1].unshift(f),!c[0].apply(null,c[1])){var p=a.length<2?a[0]:a;u.fail.call(p,e),t=!1;break}}if(!t)break}return t};var l={},u=l.rules=["empty","long","email","url","yes"],c={};c.notEmpty=function(e){for(var t=!0,n=0,i=e.length;i>n;++n)if(r(e[n])){t=!1;break}return t},c["long"]=function(e,r,t){for(var n=!0,i=0,o=e.length;o>i;++i){var a=e[i].length;if(r>a||a>t){n=!1;break}}return n},l.checkers=c;var f=function(e,r){return f[e](r)},h=function(e,r){return h[e](r)};o.is=f,o.not=h,o.not=h;for(var p=0,y=l.rules.length;y>p;++p)t(l.rules[p],l.checkers[l.rules[p]]);o.api=function(e,r,n){var a=i.type(n);if(!/is|not/.test(e))throw new TypeError('The api type "'+e+'" is not support.');var s,u="is"===e;switch(a){case i.TYPE_STRING:var c=n.split(":"),f=l.checkers[c[0]];if("undefined"==typeof f)throw new TypeError("Checker "+c[0]+" is not defined.");s=function(e){var r=f.call(this,c.slice(1));return u?r:!r};break;case i.TYPE_REGEXP:s=function(e){var r=n.test(e);return u?r:!r};break;case i.TYPE_FUNCTION:s=n;break;default:throw new TypeError("Checker must be a String/RegExp/Function.")}return t(r,s),o},o.api.list=function(){return u},e.Validator=o,e.FormValidator=s});
//# sourceMappingURL=spa-public-validator.min.js.map