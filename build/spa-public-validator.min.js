!function(r){r(window)}(function(r){function e(r){return Object.prototype.toString.call(r)}function t(r){return e(r)===b}function a(r){return r.value||r.getAttribute("data-value")||""}function u(r,e){return x[r]>=x[e]}function n(r){for(var e,t=[],a=[],n=[],s=0,o="",i="",l=r.length;l>s;)switch(e=r[s++]){case"{":case"}":case"!":o.length>0&&t.push(o),t.push(e),o="";break;case"&":case"|":e===i?(o.length>0&&t.push(o),t.push(i+i),o="",i=""):i+=e;break;default:o+=e}o.length>0&&t.push(o),s=0,l=t.length;for(var c,F;l>s;)switch(e=t[s++]){case"{":n.push(e);break;case"||":case"&&":case"!":for(c=n.length-1;c>=0&&("||"===n[c]||"&&"===n[c]||"!"===n[c])&&u(n[c],e);)a.push(n.pop()),c--;n.push(e);break;case"}":for(c=n.length-1;c>=0&&(F=n.pop(),"{"!==F);)a.push(F),c--;break;default:a.push(e)}if(n.length>0)for(c=n.length-1;c>=0&&(F=n.pop(),"{"!==F);)a.push(F),c--;return a}function s(r,t,u){var n=r.split(":");r=n[0].replace(/length/i,"long");var s,i=u?$[r]||m[r]:this.cs[r]||$[r]||m[r];switch(e(i)){case b:s=o.call(this,i,t,u);break;case w:var l,c=n.slice(1);switch(r){case"long":l=k.getLengthParams(c);break;case"range":l=k.getRangeParams(c);break;default:l=c}if(u)l.unshift(t);else{for(var F=[],h=0;h<t.length;++h)F.push(a(t[h]));l.unshift(F)}s=i.apply(null,l);break;default:throw new TypeError("Checker for rule "+n[0]+" must be a Function.")}return s}function o(r,t,a){for(var u=[],n=0;n<r.length;++n){var o=r[n];switch(o){case"&&":var i=u.pop(),l=u.pop(),c=(e(l)===d?s.call(this,l,t,a):l)&&(e(i)===d?s.call(this,i,t,a):i);u.push(c);break;case"||":var i=u.pop(),l=u.pop(),c=(e(l)===d?s.call(this,l,t,a):l)||(e(i)===d?s.call(this,i,t,a):i);u.push(c);break;case"!":var l=u.pop(),c=!(e(l)===d?s.call(this,l,t,a):l);u.push(c);break;default:u.push(o)}}var F=u.pop();return e(F)===d?s.call(this,F,t,a):F}function i(r){r=r||[],this.cs={},this.vs=[],t(r)||(r=[r]);for(var e=0;e<r.length;++e){var a=r[e].field;t(a)||(a=[a]);var u=r[e].rules;u=t(u)?u:[u];for(var s=0;s<u.length;++s)u[s].queue=n(u[s].type);this.vs.push({$fs:a,rs:u})}}function l(r){return null===r||typeof r===D||""===r}function c(r){for(var e=!0,t=0;t<r.length-1;++t)if(r[t]!==r[t+1]){e=!1;break}return e}function F(r){for(var e=!0,t=0;t<r.length;++t)if(!l(r[t])){e=!1;break}return e}function h(r,e,t){for(var a=!0,u=0;u<r.length;++u){var n=r[u].length;if(e>n||n>t){a=!1;break}}return a}function f(r,e,t,a,u){for(var n=!0,s=0;s<r.length;++s){var o=r[s];if(e&&t>o||u&&o>a||!e&&t>=o||!u&&o>=a){n=!1;break}}return n}function p(r,t){var a;switch(e(t)){case y:a=function(r){return t.test(r)};break;case w:a=t;break;default:throw new TypeError("Matcher Type Error.")}m[r]=a,C[r]=a,z[r]=function(){return!a.apply(null,arguments)}}function v(r,t){var a;switch(e(t)){case d:var u;try{u=n(t)}catch(s){throw new Error(s)}a=u;break;case y:a=function(r){return t.test(r)};break;case w:a=t;break;default:throw new TypeError("Checker must be a String/RegExp/Function.")}$[r]=a}var g=function(r){return this.hasOwnProperty(r)},d="[object String]",b="[object Array]",w="[object Function]",y="[object RegExp]",D="undefined",k={};k.trim=function(r){return r.replace(/^\s+|\s$/g,"")},k.getLengthParams=function(r){var e="The parameters for length is illegal.";r=r[0];var t=/\s*([\(\[])\s*(\d+)?\s*,\s*(\d+)?\s*([\)\]])\s*/,a=r.match(t);if(null===a)throw new TypeError(e);var u=a[2],n=a[3];if(typeof u===D)u=0;else if("("===a[1])u=+u+1;else{if("["!==a[1])throw new TypeError(e);u=+u}if(typeof n===D)n=1/0;else if(")"===a[4])n=+n-1;else{if("]"!==a[4])throw new TypeError(e);n=+n}if(u!==u||n!==n)throw new TypeError(e);return[u,n]},k.getRangeParams=function(r){var e="The parameters for range is illegal.";r=r[0];var t=/\s*([\(\[])\s*((0|([\+\-]?[1-9]\d*))(\.[0-9]+)?)?\s*,\s*((0|([\+\-]?[1-9]\d*))(\.[0-9]+)?)?\s*([\)\]])\s*/,a=r.match(t);if(null===a)throw new TypeError(e);var u,n,s=a[2],o=a[6];return s=typeof s===D?-(1/0):+s,u="["===a[1],o=typeof o===D?1/0:+o,n="]"===a[10],[u,s,o,n]};var x={"||":0,"&&":1,"!":2},E=i.prototype;E.add=function(r){function a(r,a){var u,s=a;switch(e(s)){case w:u=s;break;case d:try{u=n(s)}catch(o){throw new Error("Cannot parse rule expression.")}break;case y:u=function(r){var e=!0;if(t(r)){for(var u=0,n=r.length;n>u;++u)if(!s.test(r[u])){e=!1;break}}else a.rule.test(r)||(e=!1);return e};break;default:throw new TypeError("Rule type not support.")}this.cs[r]=u}for(var u in r)g.call(r,u)&&a.call(this,u,r[u]);return this},E.check=function(r){for(var e=!0,t=this.vs,a=0;a<t.length;++a){for(var u=t[a].$fs,n=t[a].rs,s=0;s<n.length;++s){var i=n[s];if(e=o.call(this,i.queue,u,!1),!e){var l=u.length<2?u[0]:u;i.fail.call(l,r);break}}if(!e)break}return e},E.remove=function(r){function e(r){typeof this.cs[r]!==D&&delete this.cs[r]}if(t(r))for(var a=0,u=r.length;u>a;++a)e.call(this,r[a]);else e.call(this,r);return this};var m={},A={url:/^(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?$/,email:/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i,number:/^(0|([\+\-]?[1-9]\d*))(\.[0-9]+)?$/,"int":/^(0|([\+\-]?[1-9]\d*))$/,positive:/^\+?[1-9]\d*$/,negative:/^\-[1-9]\d*$/,varName:/^[a-zA-Z_][a-zA-Z0-9_]*$/,nickName:/^[\u4E00-\u9FA5\uF900-\uFA2Da-zA-Z_][\u4E00-\u9FA5\uF900-\uFA2Da-zA-Z0-9_]*$/,QQ:/^[1-9][0-9]{4,}$/,upperCase:/^[A-Z]+$/g,lowerCase:/^[a-z]$/g,empty:F,equal:c,"long":h,range:f},$={},C=i.is=function(r,t){var a,u=$[r]||m[r];switch(e(u)){case b:a=o.call(this,u,t,!0);break;case w:a=u(t);break;default:throw new TypeError("Checker for "+r+" is not defined.")}return a},z=i.not=function(r,e){return!C(r,e)};for(var T in A)g.call(A,T)&&p(T,A[T]);i.api=function(r){for(var e in r)g.call(r,e)&&v.call(this,e,r[e]);return this},i.api.list=function(){console.log($)};var _=function(r,e){this.vs=[],this.cs={},this.$form="string"==typeof r?document.querySelectorAll(r)[0]:r,e=e||[],t(e)||(e=[e]);for(var a=0,u=e.length;u>a;++a){var s=e[a].field;t(s)||(s=[s]);for(var o=[],i=0;i<s.length;++i){var l=this.$form.querySelectorAll("[name="+s[i]+"]")[0]||this.$form.querySelectorAll("[data-name="+s[i]+"]")[0];if(typeof l===D)throw new TypeError("未找到域："+s[i]);o.push(l)}var c=e[a].rules;c=t(c)?c:[c];for(var F=0;F<c.length;++F)c[F].queue=n(c[F].type);this.vs.push({$fs:o,rs:c})}};_.prototype=new i,_.prototype.constructor=_,_.prototype.check=function(){return i.prototype.check.call(this,this.$form)},r.Validator=i,r.FormValidator=_});
//# sourceMappingURL=spa-public-validator.min.js.map